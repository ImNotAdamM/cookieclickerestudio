<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Study Cookie Clicker</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Merriweather:wght@300;400;700&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Merriweather', serif;
            background: linear-gradient(to bottom, #2b5d87 0%, #1a3a52 100%);
            color: #fff;
            overflow: hidden;
            height: 100vh;
        }

        .header {
            background: rgba(0,0,0,0.4);
            padding: 15px 20px;
            text-align: center;
            border-bottom: 3px solid #8b4513;
            position: relative;
        }

        .quote {
            font-size: 18px;
            font-style: italic;
            color: #ffd700;
            text-shadow: 2px 2px 4px #000;
            min-height: 30px;
            animation: fadeIn 0.5s;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .container {
            display: flex;
            height: calc(100vh - 63px);
        }

        .left-panel {
            width: 35%;
            background: linear-gradient(to bottom, #3d6b99 0%, #2a4d6e 100%);
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            border-right: 4px solid #8b4513;
            overflow-y: auto;
        }

        .bakery-name {
            font-size: 28px;
            color: #ffd700;
            text-shadow: 3px 3px 6px #000;
            margin-bottom: 15px;
            text-align: center;
            cursor: pointer;
            padding: 10px 20px;
            border: 2px solid transparent;
            border-radius: 10px;
            transition: all 0.3s;
        }

        .bakery-name:hover {
            border-color: #ffd700;
            background: rgba(255,215,0,0.1);
        }

        .bakery-name-input {
            font-size: 28px;
            color: #ffd700;
            text-shadow: 3px 3px 6px #000;
            background: rgba(0,0,0,0.5);
            border: 2px solid #ffd700;
            border-radius: 10px;
            padding: 10px 20px;
            text-align: center;
            font-family: 'Merriweather', serif;
        }

        .cookie-counter {
            font-size: 52px;
            color: #fff;
            text-shadow: 4px 4px 8px #000;
            margin-bottom: 5px;
            font-weight: 700;
        }

        .cps {
            font-size: 20px;
            color: #ccc;
            margin-bottom: 20px;
        }

        .cookie-container {
            position: relative;
            margin: 30px 0;
            width: 280px;
            height: 280px;
        }

        .cookie {
            width: 280px;
            height: 280px;
            border-radius: 50%;
            background: radial-gradient(circle at 35% 35%, #e0a168 0%, #d2691e 30%, #8b4513 100%);
            box-shadow: 0 15px 40px rgba(0,0,0,0.6), inset -5px -5px 20px rgba(0,0,0,0.3);
            position: relative;
            border: 5px solid #a0522d;
        }

        .cookie::before,
        .cookie::after,
        .chip1, .chip2, .chip3, .chip4, .chip5 {
            content: '';
            position: absolute;
            background: #654321;
            border-radius: 50%;
            box-shadow: inset -2px -2px 4px rgba(0,0,0,0.5);
        }

        .cookie::before {
            width: 35px;
            height: 35px;
            top: 15%;
            left: 25%;
        }

        .cookie::after {
            width: 30px;
            height: 30px;
            bottom: 25%;
            right: 20%;
        }

        .chip1 { width: 28px; height: 28px; top: 40%; left: 15%; }
        .chip2 { width: 32px; height: 32px; top: 60%; left: 40%; }
        .chip3 { width: 25px; height: 25px; top: 20%; right: 30%; }
        .chip4 { width: 30px; height: 30px; bottom: 40%; right: 35%; }
        .chip5 { width: 27px; height: 27px; top: 50%; right: 15%; }

        .cursor-pointer {
            position: absolute;
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #fff 0%, #e0e0e0 100%);
            border: 3px solid #333;
            border-radius: 50% 50% 50% 0;
            transform-origin: 0 0;
            pointer-events: none;
            box-shadow: 0 4px 8px rgba(0,0,0,0.4);
            animation: clickAnim 0.5s ease-in-out infinite;
        }

        .cursor-pointer::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 8px;
            height: 8px;
            background: #333;
            border-radius: 50%;
        }

        @keyframes clickAnim {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(0.9); }
        }

        .study-info {
            background: rgba(0,0,0,0.4);
            padding: 20px;
            border-radius: 15px;
            width: 100%;
            margin-top: 20px;
            border: 2px solid rgba(255,255,255,0.1);
        }

        .study-timer {
            font-size: 22px;
            color: #90EE90;
            margin-bottom: 12px;
        }

        .stats {
            background: rgba(0,0,0,0.4);
            padding: 20px;
            border-radius: 15px;
            margin-top: 20px;
            width: 100%;
            border: 2px solid rgba(255,255,255,0.1);
        }

        .stats h3 {
            color: #ffd700;
            margin-bottom: 15px;
            font-size: 20px;
        }

        .stat-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-size: 15px;
        }

        .achievements {
            background: rgba(0,0,0,0.4);
            padding: 20px;
            border-radius: 15px;
            margin-top: 20px;
            width: 100%;
            border: 2px solid rgba(255,215,0,0.3);
        }

        .achievements h3 {
            color: #ffd700;
            margin-bottom: 15px;
            font-size: 20px;
        }

        .achievement {
            background: rgba(139, 69, 19, 0.5);
            border: 2px solid #8b4513;
            border-radius: 8px;
            padding: 10px;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            opacity: 0.4;
            transition: all 0.3s;
        }

        .achievement.unlocked {
            opacity: 1;
            border-color: #ffd700;
            background: rgba(255, 215, 0, 0.2);
        }

        .achievement-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 12px;
            font-size: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.3);
        }

        .achievement-info {
            flex-grow: 1;
        }

        .achievement-name {
            font-size: 14px;
            font-weight: bold;
            color: #fff;
        }

        .achievement-desc {
            font-size: 12px;
            color: #ccc;
        }

        .center-panel {
            width: 35%;
            background: linear-gradient(135deg, #4a7c9e 0%, #2d5670 100%);
            padding: 0;
            overflow-y: auto;
            border-right: 4px solid #8b4513;
            position: relative;
        }

        .center-panel h2 {
            background: rgba(0,0,0,0.5);
            color: #ffd700;
            text-shadow: 2px 2px 4px #000;
            padding: 15px;
            text-align: center;
            font-size: 26px;
            position: sticky;
            top: 0;
            z-index: 10;
            border-bottom: 3px solid #8b4513;
        }

        .buildings-display {
            min-height: 400px;
            padding: 20px;
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100"><rect fill="%23567856" width="100" height="100"/><circle cx="50" cy="50" r="30" fill="%234a6b4a" opacity="0.1"/></svg>');
        }

        .building-item {
            background: rgba(139, 69, 19, 0.3);
            border: 3px solid #8b4513;
            border-radius: 15px;
            padding: 15px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            transition: transform 0.2s;
        }

        .building-item:hover {
            transform: translateY(-5px);
        }

        .building-item-icon {
            font-size: 50px;
            margin-bottom: 10px;
            filter: drop-shadow(2px 2px 4px rgba(0,0,0,0.5));
        }

        .building-item-count {
            font-size: 24px;
            color: #ffd700;
            font-weight: bold;
        }

        .building-item-name {
            font-size: 14px;
            color: #fff;
            margin-top: 5px;
        }

        .right-panel {
            width: 30%;
            background: linear-gradient(to bottom, #3d6b99 0%, #2a4d6e 100%);
            padding: 0;
            overflow-y: auto;
        }

        .right-panel h2 {
            background: rgba(0,0,0,0.5);
            color: #ffd700;
            text-shadow: 2px 2px 4px #000;
            padding: 15px;
            text-align: center;
            font-size: 24px;
            position: sticky;
            top: 0;
            z-index: 10;
            border-bottom: 3px solid #8b4513;
        }

        .section-divider {
            background: rgba(0,0,0,0.5);
            color: #90EE90;
            text-shadow: 2px 2px 4px #000;
            padding: 12px;
            text-align: center;
            font-size: 18px;
            border-top: 2px solid #8b4513;
            border-bottom: 2px solid #8b4513;
            margin-top: 10px;
        }

        .upgrades-section {
            padding: 15px;
        }

        .upgrade {
            background: linear-gradient(135deg, rgba(139, 69, 19, 0.7) 0%, rgba(101, 67, 33, 0.7) 100%);
            border: 3px solid #8b4513;
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 12px;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
        }

        .upgrade:hover {
            transform: translateX(-5px);
            box-shadow: 0 6px 15px rgba(0,0,0,0.5);
            border-color: #ffd700;
        }

        .upgrade.locked {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .upgrade.cooldown {
            opacity: 0.6;
            cursor: not-allowed;
            background: linear-gradient(135deg, rgba(100, 100, 100, 0.7) 0%, rgba(70, 70, 70, 0.7) 100%);
        }

        .upgrade-header {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }

        .upgrade-icon {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, #8b4513 0%, #654321 100%);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
            margin-right: 12px;
            box-shadow: 0 3px 8px rgba(0,0,0,0.4);
        }

        .upgrade-info {
            flex-grow: 1;
        }

        .upgrade-name {
            font-size: 18px;
            color: #fff;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .upgrade-cost {
            font-size: 15px;
            color: #ffd700;
            font-weight: bold;
        }

        .upgrade-desc {
            font-size: 13px;
            color: #ccc;
            margin-top: 5px;
        }

        .upgrade-count {
            font-size: 20px;
            color: #90EE90;
            font-weight: bold;
        }

        .cooldown-timer {
            font-size: 12px;
            color: #ff6347;
            margin-top: 5px;
            font-weight: bold;
        }

        .conquest-upgrade {
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.3) 0%, rgba(255, 140, 0, 0.3) 100%);
            border: 4px solid #ffd700;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { box-shadow: 0 0 20px rgba(255,215,0,0.5); }
            50% { box-shadow: 0 0 40px rgba(255,215,0,0.8); }
        }

        .missions-section {
            padding: 15px;
            border-top: 3px solid #8b4513;
            background: rgba(0,0,0,0.2);
        }

        .missions-section h3 {
            color: #ffd700;
            margin-bottom: 15px;
            font-size: 20px;
            text-align: center;
        }

        .add-mission {
            background: rgba(50, 150, 50, 0.3);
            border: 3px dashed #90EE90;
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 15px;
        }

        .add-mission h4 {
            color: #90EE90;
            margin-bottom: 12px;
            font-size: 16px;
        }

        .add-mission input {
            width: 100%;
            padding: 10px;
            margin-bottom: 10px;
            border: 2px solid #654321;
            border-radius: 8px;
            background: rgba(255,255,255,0.95);
            font-size: 14px;
            font-family: 'Merriweather', serif;
        }

        .add-mission button {
            width: 100%;
            background: linear-gradient(135deg, #228b22 0%, #1a6b1a 100%);
            border: 2px solid #1a6b1a;
            color: #fff;
            padding: 12px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: all 0.2s;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
        }

        .add-mission button:hover {
            background: linear-gradient(135deg, #1a6b1a 0%, #145214 100%);
            transform: translateY(-2px);
        }

        .mission {
            background: rgba(139, 69, 19, 0.6);
            border: 2px solid #654321;
            border-radius: 10px;
            padding: 12px;
            margin-bottom: 10px;
        }

        .mission-title {
            font-size: 16px;
            color: #ffd700;
            margin-bottom: 8px;
        }

        .mission-reward {
            font-size: 13px;
            color: #90EE90;
            margin-bottom: 10px;
        }

        .mission-buttons {
            display: flex;
            gap: 8px;
        }

        .mission-btn {
            flex: 1;
            background: #8b4513;
            border: 2px solid #654321;
            color: #fff;
            padding: 8px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 13px;
            transition: all 0.2s;
            font-family: 'Merriweather', serif;
        }

        .mission-btn:hover {
            background: #654321;
            transform: scale(1.05);
        }

        .mission-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .mission-btn.delete {
            background: #8b0000;
            border-color: #5a0000;
        }

        .mission-btn.delete:hover {
            background: #5a0000;
        }

        .notification {
            position: fixed;
            top: 80px;
            right: 20px;
            background: linear-gradient(135deg, rgba(139, 69, 19, 0.98) 0%, rgba(101, 67, 33, 0.98) 100%);
            border: 3px solid #ffd700;
            border-radius: 12px;
            padding: 15px 25px;
            color: #fff;
            font-size: 16px;
            box-shadow: 0 8px 20px rgba(0,0,0,0.6);
            animation: slideIn 0.3s ease-out;
            z-index: 1000;
            max-width: 300px;
        }

        @keyframes slideIn {
            from {
                transform: translateX(400px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.85);
            z-index: 2000;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background: linear-gradient(to bottom, #3d6b99 0%, #2a4d6e 100%);
            border: 6px solid #ffd700;
            border-radius: 25px;
            padding: 50px;
            max-width: 600px;
            text-align: center;
            box-shadow: 0 10px 50px rgba(0,0,0,0.8);
        }

        .modal-content h2 {
            color: #ffd700;
            font-size: 42px;
            margin-bottom: 25px;
            text-shadow: 4px 4px 8px #000;
        }

        .modal-content p {
            font-size: 22px;
            margin-bottom: 30px;
            line-height: 1.6;
        }

        .modal-btn {
            background: linear-gradient(135deg, #8b4513 0%, #654321 100%);
            border: 3px solid #654321;
            color: #fff;
            padding: 18px 40px;
            border-radius: 12px;
            cursor: pointer;
            font-size: 20px;
            font-weight: bold;
            transition: all 0.3s;
            box-shadow: 0 6px 15px rgba(0,0,0,0.5);
            font-family: 'Merriweather', serif;
        }

        .modal-btn:hover {
            background: linear-gradient(135deg, #654321 0%, #4a2f1a 100%);
            transform: scale(1.1);
        }

        ::-webkit-scrollbar {
            width: 12px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(0,0,0,0.4);
        }

        ::-webkit-scrollbar-thumb {
            background: #8b4513;
            border-radius: 6px;
            border: 2px solid rgba(0,0,0,0.4);
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #654321;
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="quote" id="randomQuote">Comienza tu viaje hacia la conquista del mundo...</div>
    </div>

    <div class="container">
        <div class="left-panel">
            <div class="bakery-name" id="bakeryName" onclick="editBakeryName()">Mi Panader√≠a de Estudio</div>
            <div class="cookie-counter" id="cookieCount">0</div>
            <div class="cps">galletas</div>
            <div class="cps">por segundo: <span id="cps">0</span></div>
            
            <div class="cookie-container" id="cookieContainer">
                <div class="cookie" id="mainCookie">
                    <div class="chip1"></div>
                    <div class="chip2"></div>
                    <div class="chip3"></div>
                    <div class="chip4"></div>
                    <div class="chip5"></div>
                </div>
            </div>
            
            <div class="study-info">
                <div class="study-timer">Tiempo estudiando: <span id="studyTime">00:00:00</span></div>
                <div class="cps">Galletas de estudio: <span id="studyCookies">0</span></div>
            </div>

            <div class="stats">
                <h3>Estad√≠sticas</h3>
                <div class="stat-item">
                    <span>Total de galletas:</span>
                    <span id="totalCookies">0</span>
                </div>
                <div class="stat-item">
                    <span>Galletas por segundo:</span>
                    <span id="cpsDisplay">0</span>
                </div>
                <div class="stat-item">
                    <span>Edificios totales:</span>
                    <span id="totalBuildings">0</span>
                </div>
                <div class="stat-item">
                    <span>Renacimientos:</span>
                    <span id="rebirthCount">0</span>
                </div>
            </div>
        </div>

        <div class="center-panel">
            <h2>Tus Edificios</h2>
            <div class="buildings-display" id="buildingsDisplay">
                <div style="grid-column: 1/-1; text-align: center; color: #aaa; padding: 40px;">
                    Compra edificios para verlos aparecer aqu√≠...
                </div>
            </div>
        </div>

        <div class="right-panel">
            <h2>Mejoras</h2>
            <div class="upgrades-section" id="buildingsContainer"></div>
            
            <div class="section-divider">Potenciadores de Eficiencia</div>
            <div class="upgrades-section" id="efficiencyContainer"></div>
            
            <div class="missions-section">
                <h3>Misiones de Estudio</h3>
                
                <div class="add-mission">
                    <h4>Crear Nueva Misi√≥n</h4>
                    <input type="text" id="missionTitle" placeholder="T√≠tulo (ej: Leer 50 p√°ginas)" maxlength="50">
                    <input type="number" id="missionReward" placeholder="Recompensa (m√°x: 10,000)" min="1" max="10000">
                    <button onclick="addMission()">A√±adir Misi√≥n</button>
                </div>

                <div id="missionsContainer"></div>
            </div>
        </div>
    </div>

    <div class="modal" id="conquestModal">
        <div class="modal-content">
            <h2>CONQUISTA MUNDIAL</h2>
            <p>Has conquistado el mundo con el poder del estudio y las galletas!</p>
            <p style="font-size: 18px; color: #ffd700;">Reiniciar√°s con bonificaciones permanentes.</p>
            <button class="modal-btn" onclick="doRebirth()">Renacer y Mejorar</button>
        </div>
    </div>

    <script>
        const quotesData = {
            beginner: [
                "Tus primeras galletas salen del horno...",
                "El aroma a galletas frescas llena el aire.",
                "Tus padres prueban tus galletas. No est√° mal, dicen.",
                "Estudiar nunca hab√≠a sido tan dulce.",
                "Cada hora de estudio se convierte en una deliciosa galleta.",
                "Tu familia acepta probar algunas de tus galletas."
            ],
            intermediate: [
                "Tu panader√≠a empieza a llamar la atenci√≥n.",
                "Los vecinos hablan de tus galletas.",
                "Las galletas de estudio son un concepto revolucionario.",
                "Tu dedicaci√≥n comienza a dar frutos.",
                "El conocimiento y las galletas crecen en armon√≠a.",
                "Tus amigos quieren la receta secreta."
            ],
            advanced: [
                "Tu imperio de galletas se expande r√°pidamente.",
                "Los medios locales escriben sobre tu panader√≠a.",
                "Tu m√©todo de estudio inspira a toda la ciudad.",
                "Las universidades estudian tu t√©cnica √∫nica.",
                "Tu fama trasciende las fronteras locales.",
                "Eres reconocido como el maestro panadero estudiante."
            ],
            master: [
                "Tu imperio domina la industria mundial de galletas.",
                "Los gobiernos solicitan tus galletas de estudio.",
                "Eres una leyenda viviente de la reposter√≠a.",
                "Tu m√©todo revoluciona la educaci√≥n global.",
                "El mundo entero conoce tus galletas.",
                "Tu legado ser√° recordado por siglos."
            ],
            legendary: [
                "Las galletas de estudio son patrimonio de la humanidad.",
                "Civilizaciones extraterrestres piden tus recetas.",
                "Has trascendido los l√≠mites del espacio y tiempo.",
                "Tu nombre es sin√≥nimo de sabidur√≠a y dulzura.",
                "El universo se inclina ante tu grandeza.",
                "Eres inmortal en la historia de la panader√≠a."
            ]
        };

        let currentQuoteIndex = 0;
        let currentQuoteSet = 'beginner';

        function getQuoteSet() {
            const total = gameState.totalCookies;
            if (total < 1000) return 'beginner';
            if (total < 100000) return 'intermediate';
            if (total < 10000000) return 'advanced';
            if (total < 1000000000) return 'master';
            return 'legendary';
        }

        function updateQuote() {
            const quoteEl = document.getElementById('randomQuote');
            const newSet = getQuoteSet();
            
            if (newSet !== currentQuoteSet) {
                currentQuoteSet = newSet;
                currentQuoteIndex = 0;
            }
            
            const quotes = quotesData[currentQuoteSet];
            currentQuoteIndex = (currentQuoteIndex + 1) % quotes.length;
            
            quoteEl.style.opacity = '0';
            setTimeout(() => {
                quoteEl.textContent = quotes[currentQuoteIndex];
                quoteEl.style.opacity = '1';
            }, 300);
        }

        setInterval(updateQuote, 10000);

        const gameState = {
            cookies: 0,
            totalCookies: 0,
            cps: 0,
            studyTime: 0,
            studyCookies: 0,
            conquered: false,
            rebirths: 0,
            bakeryName: 'Mi Panader√≠a de Estudio',
            isActive: true
        };

        // Detectar cambio de pesta√±a
        document.addEventListener('visibilitychange', function() {
            if (document.hidden) {
                gameState.isActive = false;
                showNotification('Pausa: Vuelve a la pesta√±a para seguir estudiando!');
            } else {
                gameState.isActive = true;
                showNotification('Bienvenido de vuelta! Sigues estudiando...');
            }
        });

        // Detectar foco de ventana
        window.addEventListener('blur', function() {
            gameState.isActive = false;
        });

        window.addEventListener('focus', function() {
            gameState.isActive = true;
        });

        const buildings = [
            { id: 'cursor', name: 'Cursor', baseCost: 15, cps: 0.1, count: 0, cooldown: 0, icon: 'üëÜ' },
            { id: 'grandma', name: 'Abuela', baseCost: 100, cps: 1, count: 0, cooldown: 0, icon: 'üëµ' },
            { id: 'farm', name: 'Granja', baseCost: 1100, cps: 8, count: 0, cooldown: 0, icon: 'üåæ' },
            { id: 'mine', name: 'Mina', baseCost: 12000, cps: 47, count: 0, cooldown: 0, icon: '‚õèÔ∏è' },
            { id: 'factory', name: 'F√°brica', baseCost: 130000, cps: 260, count: 0, cooldown: 0, icon: 'üè≠' },
            { id: 'bank', name: 'Banco', baseCost: 1400000, cps: 1400, count: 0, cooldown: 0, icon: 'üè¶' },
            { id: 'temple', name: 'Templo', baseCost: 20000000, cps: 7800, count: 0, cooldown: 0, icon: '‚õ™' },
            { id: 'tower', name: 'Torre M√°gica', baseCost: 330000000, cps: 44000, count: 0, cooldown: 0, icon: 'üóº' },
            { id: 'shipment', name: 'Env√≠os', baseCost: 5100000000, cps: 260000, count: 0, cooldown: 0, icon: 'üö¢' },
            { id: 'lab', name: 'Laboratorio', baseCost: 75000000000, cps: 1600000, count: 0, cooldown: 0, icon: 'üî¨' },
            { id: 'portal', name: 'Portal', baseCost: 1000000000000, cps: 10000000, count: 0, cooldown: 0, icon: 'üåÄ' },
            { id: 'timemachine', name: 'M√°quina del Tiempo', baseCost: 14000000000000, cps: 65000000, count: 0, cooldown: 0, icon: '‚è∞' },
            { id: 'antimatter', name: 'Condensador', baseCost: 170000000000000, cps: 430000000, count: 0, cooldown: 0, icon: '‚öõÔ∏è' },
            { id: 'prism', name: 'Prisma', baseCost: 2100000000000000, cps: 2900000000, count: 0, cooldown: 0, icon: 'üîÆ' },
            { id: 'chancemaker', name: 'Alterador', baseCost: 26000000000000000, cps: 21000000000, count: 0, cooldown: 0, icon: 'üé≤' }
        ];

        const efficiencyUpgrades = [
            { id: 'cursor_eff', name: 'Cursores Mejorados', target: 'cursor', baseCost: 100, multiplier: 2, count: 0, cooldown: 0 },
            { id: 'grandma_eff', name: 'Abuelas Expertas', target: 'grandma', baseCost: 1000, multiplier: 2, count: 0, cooldown: 0 },
            { id: 'farm_eff', name: 'Fertilizantes Premium', target: 'farm', baseCost: 11000, multiplier: 2, count: 0, cooldown: 0 },
            { id: 'mine_eff', name: 'Excavadoras Industriales', target: 'mine', baseCost: 120000, multiplier: 2, count: 0, cooldown: 0 },
            { id: 'factory_eff', name: 'Automatizaci√≥n Total', target: 'factory', baseCost: 1300000, multiplier: 2, count: 0, cooldown: 0 },
            { id: 'bank_eff', name: 'Inversiones Estrat√©gicas', target: 'bank', baseCost: 14000000, multiplier: 2, count: 0, cooldown: 0 },
            { id: 'temple_eff', name: 'Bendiciones Divinas', target: 'temple', baseCost: 200000000, multiplier: 2, count: 0, cooldown: 0 },
            { id: 'tower_eff', name: 'Hechizos Ancestrales', target: 'tower', baseCost: 3300000000, multiplier: 2, count: 0, cooldown: 0 },
            { id: 'shipment_eff', name: 'Rutas Comerciales', target: 'shipment', baseCost: 51000000000, multiplier: 2, count: 0, cooldown: 0 },
            { id: 'lab_eff', name: 'Investigaci√≥n Avanzada', target: 'lab', baseCost: 750000000000, multiplier: 2, count: 0, cooldown: 0 }
        ];

        const achievements = [
            { id: 'first_cookie', name: 'Primera Galleta', desc: 'Obt√©n tu primera galleta', condition: () => gameState.totalCookies >= 1, unlocked: false },
            { id: 'hundred', name: 'Centenario', desc: 'Obt√©n 100 galletas', condition: () => gameState.totalCookies >= 100, unlocked: false },
            { id: 'thousand', name: 'Millar', desc: 'Obt√©n 1,000 galletas', condition: () => gameState.totalCookies >= 1000, unlocked: false },
            { id: 'first_building', name: 'Constructor', desc: 'Compra tu primer edificio', condition: () => buildings.some(b => b.count > 0), unlocked: false },
            { id: 'ten_buildings', name: 'Empresario', desc: 'Posee 10 edificios en total', condition: () => buildings.reduce((sum, b) => sum + b.count, 0) >= 10, unlocked: false },
            { id: 'million', name: 'Millonario', desc: 'Obt√©n 1,000,000 galletas', condition: () => gameState.totalCookies >= 1000000, unlocked: false },
            { id: 'billion', name: 'Magnate', desc: 'Obt√©n 1,000,000,000 galletas', condition: () => gameState.totalCookies >= 1000000000, unlocked: false },
            { id: 'first_rebirth', name: 'Renacimiento', desc: 'Completa tu primer renacimiento', condition: () => gameState.rebirths >= 1, unlocked: false },
            { id: 'five_rebirths', name: 'Maestro Eterno', desc: 'Completa 5 renacimientos', condition: () => gameState.rebirths >= 5, unlocked: false },
            { id: 'study_hour', name: 'Estudiante Dedicado', desc: 'Estudia durante 1 hora', condition: () => gameState.studyTime >= 3600, unlocked: false },
            { id: 'study_day', name: 'Marat√≥n de Estudio', desc: 'Estudia durante 24 horas', condition: () => gameState.studyTime >= 86400, unlocked: false },
            { id: 'hundred_buildings', name: 'Imperio Industrial', desc: 'Posee 100 edificios en total', condition: () => buildings.reduce((sum, b) => sum + b.count, 0) >= 100, unlocked: false }
        ];

        let missions = [];
        let cursorPositions = [];

        function init() {
            renderBuildings();
            renderEfficiencyUpgrades();
            renderMissions();
            renderBuildingsDisplay();
            
            setInterval(update, 100);
            setInterval(updateStudyTime, 1000);
            setInterval(updateCooldowns, 1000);
            setInterval(checkAchievements, 1000);
            setInterval(animateCursors, 50);
            
            updateDisplay();
        }

        function editBakeryName() {
            const nameEl = document.getElementById('bakeryName');
            const currentName = gameState.bakeryName;
            
            const input = document.createElement('input');
            input.type = 'text';
            input.value = currentName;
            input.className = 'bakery-name-input';
            input.maxLength = 30;
            
            nameEl.replaceWith(input);
            input.focus();
            input.select();
            
            function saveName() {
                const newName = input.value.trim() || 'Mi Panader√≠a';
                gameState.bakeryName = newName;
                
                const nameDiv = document.createElement('div');
                nameDiv.id = 'bakeryName';
                nameDiv.className = 'bakery-name';
                nameDiv.textContent = newName;
                nameDiv.onclick = editBakeryName;
                
                input.replaceWith(nameDiv);
            }
            
            input.addEventListener('blur', saveName);
            input.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') saveName();
            });
        }

        function update() {
            const bonus = 1 + (gameState.rebirths * 0.15);
            gameState.cookies += (gameState.cps / 10) * bonus;
            gameState.totalCookies += (gameState.cps / 10) * bonus;
            updateDisplay();
        }

        function updateStudyTime() {
            gameState.studyTime++;
            const bonus = 1 + (gameState.rebirths * 0.15);
            gameState.cookies += 1 * bonus;
            gameState.totalCookies += 1 * bonus;
            gameState.studyCookies += 1 * bonus;
            
            const hours = Math.floor(gameState.studyTime / 3600);
            const minutes = Math.floor((gameState.studyTime % 3600) / 60);
            const seconds = gameState.studyTime % 60;
            
            document.getElementById('studyTime').textContent = 
                `${pad(hours)}:${pad(minutes)}:${pad(seconds)}`;
            document.getElementById('studyCookies').textContent = formatNumber(gameState.studyCookies);
        }

        function updateCooldowns() {
            buildings.forEach(building => {
                if (building.cooldown > 0) {
                    building.cooldown--;
                    renderBuildings();
                }
            });
            
            efficiencyUpgrades.forEach(upgrade => {
                if (upgrade.cooldown > 0) {
                    upgrade.cooldown--;
                    renderEfficiencyUpgrades();
                }
            });
        }

        function animateCursors() {
            const cursorBuilding = buildings.find(b => b.id === 'cursor');
            if (!cursorBuilding || cursorBuilding.count === 0) {
                cursorPositions = [];
                const container = document.getElementById('cookieContainer');
                const existingCursors = container.querySelectorAll('.cursor-pointer');
                existingCursors.forEach(c => c.remove());
                return;
            }
            
            const container = document.getElementById('cookieContainer');
            const existingCursors = container.querySelectorAll('.cursor-pointer');
            
            if (existingCursors.length !== cursorBuilding.count) {
                existingCursors.forEach(c => c.remove());
                cursorPositions = [];
                
                for (let i = 0; i < cursorBuilding.count; i++) {
                    const angle = (i / cursorBuilding.count) * Math.PI * 2;
                    const radius = 160;
                    const x = Math.cos(angle) * radius + 140;
                    const y = Math.sin(angle) * radius + 140;
                    
                    const cursor = document.createElement('div');
                    cursor.className = 'cursor-pointer';
                    cursor.style.left = x + 'px';
                    cursor.style.top = y + 'px';
                    cursor.style.transform = `rotate(${angle * 180 / Math.PI + 135}deg)`;
                    container.appendChild(cursor);
                    
                    cursorPositions.push({ angle, element: cursor });
                }
            }
        }

        function pad(num) {
            return num.toString().padStart(2, '0');
        }

        function buyBuilding(buildingId) {
            const building = buildings.find(b => b.id === buildingId);
            if (!building) return;
            
            if (building.cooldown > 0) {
                showNotification('Edificio en cooldown!');
                return;
            }
            
            const cost = Math.floor(building.baseCost * Math.pow(1.15, building.count));
            
            if (gameState.cookies >= cost) {
                gameState.cookies -= cost;
                building.count++;
                building.cooldown = 600;
                calculateCPS();
                renderBuildings();
                renderBuildingsDisplay();
                updateDisplay();
                showNotification(`${building.name} comprado!`);
            } else {
                showNotification('No tienes suficientes galletas!');
            }
        }

        function buyEfficiency(upgradeId) {
            const upgrade = efficiencyUpgrades.find(u => u.id === upgradeId);
            if (!upgrade) return;
            
            if (upgrade.cooldown > 0) {
                showNotification('Mejora en cooldown!');
                return;
            }
            
            const cost = Math.floor(upgrade.baseCost * Math.pow(2, upgrade.count));
            
            if (gameState.cookies >= cost) {
                gameState.cookies -= cost;
                upgrade.count++;
                upgrade.cooldown = 600;
                calculateCPS();
                renderEfficiencyUpgrades();
                updateDisplay();
                showNotification(`${upgrade.name} mejorado!`);
            } else {
                showNotification('No tienes suficientes galletas!');
            }
        }

        function calculateCPS() {
            gameState.cps = 0;
            
            buildings.forEach(building => {
                let buildingCPS = building.cps * building.count;
                
                const effUpgrade = efficiencyUpgrades.find(u => u.target === building.id);
                if (effUpgrade && effUpgrade.count > 0) {
                    buildingCPS *= Math.pow(effUpgrade.multiplier, effUpgrade.count);
                }
                
                gameState.cps += buildingCPS;
            });
        }

        function renderBuildings() {
            const container = document.getElementById('buildingsContainer');
            container.innerHTML = '';
            
            buildings.forEach(building => {
                const cost = Math.floor(building.baseCost * Math.pow(1.15, building.count));
                const canAfford = gameState.cookies >= cost;
                const onCooldown = building.cooldown > 0;
                
                const div = document.createElement('div');
                div.className = `upgrade ${!canAfford ? 'locked' : ''} ${onCooldown ? 'cooldown' : ''}`;
                if (!onCooldown) {
                    div.onclick = () => buyBuilding(building.id);
                }
                
                let cooldownText = '';
                if (onCooldown) {
                    const mins = Math.floor(building.cooldown / 60);
                    const secs = building.cooldown % 60;
                    cooldownText = `<div class="cooldown-timer">Cooldown: ${mins}:${pad(secs)}</div>`;
                }
                
                div.innerHTML = `
                    <div class="upgrade-header">
                        <div class="upgrade-icon">${building.icon}</div>
                        <div class="upgrade-info">
                            <div class="upgrade-name">${building.name}</div>
                            <div class="upgrade-cost">${formatNumber(cost)} galletas</div>
                            <div class="upgrade-desc">Produce ${formatNumber(building.cps)}/seg</div>
                            ${cooldownText}
                        </div>
                        <div class="upgrade-count">${building.count}</div>
                    </div>
                `;
                
                container.appendChild(div);
            });

            const conquestDiv = document.createElement('div');
            const conquestCost = 1000000000000000000; // 1 quintill√≥n
            const canConquer = gameState.totalCookies >= conquestCost;
            conquestDiv.className = `upgrade conquest-upgrade ${!canConquer ? 'locked' : ''}`;
            if (canConquer) {
                conquestDiv.onclick = () => showConquestModal();
            }
            
            conquestDiv.innerHTML = `
                <div class="upgrade-header">
                    <div class="upgrade-icon">üåç</div>
                    <div class="upgrade-info">
                        <div class="upgrade-name">CONQUISTAR EL MUNDO</div>
                        <div class="upgrade-cost">${formatNumber(conquestCost)} galletas totales</div>
                        <div class="upgrade-desc">Reinicia con +15% producci√≥n permanente</div>
                    </div>
                </div>
                <div style="margin-top: 10px; font-size: 14px; text-align: center;">
                    Progreso: ${((gameState.totalCookies / conquestCost) * 100).toFixed(4)}%
                </div>
            `;
            
            container.appendChild(conquestDiv);
        }

        function renderEfficiencyUpgrades() {
            const container = document.getElementById('efficiencyContainer');
            container.innerHTML = '';
            
            efficiencyUpgrades.forEach(upgrade => {
                const targetBuilding = buildings.find(b => b.id === upgrade.target);
                if (!targetBuilding || targetBuilding.count === 0) return;
                
                const cost = Math.floor(upgrade.baseCost * Math.pow(2, upgrade.count));
                const canAfford = gameState.cookies >= cost;
                const onCooldown = upgrade.cooldown > 0;
                
                const div = document.createElement('div');
                div.className = `upgrade ${!canAfford ? 'locked' : ''} ${onCooldown ? 'cooldown' : ''}`;
                if (!onCooldown) {
                    div.onclick = () => buyEfficiency(upgrade.id);
                }
                
                let cooldownText = '';
                if (onCooldown) {
                    const mins = Math.floor(upgrade.cooldown / 60);
                    const secs = upgrade.cooldown % 60;
                    cooldownText = `<div class="cooldown-timer">Cooldown: ${mins}:${pad(secs)}</div>`;
                }
                
                div.innerHTML = `
                    <div class="upgrade-header">
                        <div class="upgrade-icon">‚¨ÜÔ∏è</div>
                        <div class="upgrade-info">
                            <div class="upgrade-name">${upgrade.name}</div>
                            <div class="upgrade-cost">${formatNumber(cost)} galletas</div>
                            <div class="upgrade-desc">Duplica producci√≥n de ${targetBuilding.name}</div>
                            ${cooldownText}
                        </div>
                        <div class="upgrade-count">${upgrade.count}</div>
                    </div>
                `;
                
                container.appendChild(div);
            });
        }

        function renderBuildingsDisplay() {
            const container = document.getElementById('buildingsDisplay');
            
            const ownedBuildings = buildings.filter(b => b.count > 0);
            
            if (ownedBuildings.length === 0) {
                container.innerHTML = '<div style="grid-column: 1/-1; text-align: center; color: #aaa; padding: 40px;">Compra edificios para verlos aparecer aqu√≠...</div>';
                return;
            }
            
            container.innerHTML = '';
            ownedBuildings.forEach(building => {
                const div = document.createElement('div');
                div.className = 'building-item';
                
                div.innerHTML = `
                    <div class="building-item-icon">${building.icon}</div>
                    <div class="building-item-count">${building.count}</div>
                    <div class="building-item-name">${building.name}</div>
                `;
                
                container.appendChild(div);
            });
        }

        function renderAchievements() {
            const container = document.getElementById('achievementsContainer');
            container.innerHTML = '';
            
            achievements.forEach(achievement => {
                const div = document.createElement('div');
                div.className = `achievement ${achievement.unlocked ? 'unlocked' : ''}`;
                
                div.innerHTML = `
                    <div class="achievement-icon">üèÜ</div>
                    <div class="achievement-info">
                        <div class="achievement-name">${achievement.name}</div>
                        <div class="achievement-desc">${achievement.desc}</div>
                    </div>
                `;
                
                container.appendChild(div);
            });
        }

        function checkAchievements() {
            achievements.forEach(achievement => {
                if (!achievement.unlocked && achievement.condition()) {
                    achievement.unlocked = true;
                    showNotification(`Logro desbloqueado: ${achievement.name}!`);
                }
            });
        }

        function addMission() {
            const title = document.getElementById('missionTitle').value.trim();
            const reward = parseInt(document.getElementById('missionReward').value);
            
            if (!title) {
                showNotification('Escribe un t√≠tulo para la misi√≥n');
                return;
            }
            
            if (!reward || reward < 1 || reward > 10000) {
                showNotification('La recompensa debe ser entre 1 y 10,000');
                return;
            }
            
            missions.push({
                id: Date.now(),
                title: title,
                reward: reward,
                completed: false
            });
            
            document.getElementById('missionTitle').value = '';
            document.getElementById('missionReward').value = '';
            
            renderMissions();
            showNotification('Misi√≥n a√±adida!');
        }

        function completeMission(missionId) {
            const mission = missions.find(m => m.id === missionId);
            if (mission && !mission.completed) {
                mission.completed = true;
                const bonus = 1 + (gameState.rebirths * 0.15);
                const totalReward = Math.floor(mission.reward * bonus);
                gameState.cookies += totalReward;
                gameState.totalCookies += totalReward;
                showNotification(`Misi√≥n completada! +${formatNumber(totalReward)} galletas`);
                renderMissions();
                updateDisplay();
            }
        }

        function deleteMission(missionId) {
            missions = missions.filter(m => m.id !== missionId);
            renderMissions();
            showNotification('Misi√≥n eliminada');
        }

        function renderMissions() {
            const container = document.getElementById('missionsContainer');
            container.innerHTML = '';
            
            missions.forEach(mission => {
                const div = document.createElement('div');
                div.className = 'mission';
                div.style.opacity = mission.completed ? '0.6' : '1';
                
                const bonus = 1 + (gameState.rebirths * 0.15);
                const totalReward = Math.floor(mission.reward * bonus);
                
                div.innerHTML = `
                    <div class="mission-title">${mission.title}</div>
                    <div class="mission-reward">Recompensa: ${formatNumber(totalReward)} galletas</div>
                    <div class="mission-buttons">
                        <button class="mission-btn" onclick="completeMission(${mission.id})" ${mission.completed ? 'disabled' : ''}>
                            ${mission.completed ? 'Completada' : 'Completar'}
                        </button>
                        <button class="mission-btn delete" onclick="deleteMission(${mission.id})">
                            Eliminar
                        </button>
                    </div>
                `;
                
                container.appendChild(div);
            });
        }

        function updateDisplay() {
            document.getElementById('cookieCount').textContent = formatNumber(Math.floor(gameState.cookies));
            const bonus = 1 + (gameState.rebirths * 0.15);
            document.getElementById('cps').textContent = formatNumber(gameState.cps * bonus);
            document.getElementById('cpsDisplay').textContent = formatNumber(gameState.cps * bonus);
            document.getElementById('totalCookies').textContent = formatNumber(Math.floor(gameState.totalCookies));
            document.getElementById('totalBuildings').textContent = buildings.reduce((sum, b) => sum + b.count, 0);
            document.getElementById('rebirthCount').textContent = gameState.rebirths;
        }

        function formatNumber(num) {
            if (num >= 1e24) return (num / 1e24).toFixed(2) + 'Sp';
            if (num >= 1e21) return (num / 1e21).toFixed(2) + 'Sx';
            if (num >= 1e18) return (num / 1e18).toFixed(2) + 'Qi';
            if (num >= 1e15) return (num / 1e15).toFixed(2) + 'Q';
            if (num >= 1e12) return (num / 1e12).toFixed(2) + 'T';
            if (num >= 1e9) return (num / 1e9).toFixed(2) + 'B';
            if (num >= 1e6) return (num / 1e6).toFixed(2) + 'M';
            if (num >= 1e3) return (num / 1e3).toFixed(2) + 'K';
            return Math.floor(num).toString();
        }

        function showNotification(message) {
            const notif = document.createElement('div');
            notif.className = 'notification';
            notif.textContent = message;
            document.body.appendChild(notif);
            
            setTimeout(() => {
                notif.style.animation = 'slideIn 0.3s ease-out reverse';
                setTimeout(() => notif.remove(), 300);
            }, 2500);
        }

        function showConquestModal() {
            document.getElementById('conquestModal').style.display = 'flex';
        }

        function closeModal() {
            document.getElementById('conquestModal').style.display = 'none';
        }

        function doRebirth() {
            gameState.rebirths++;
            gameState.cookies = 0;
            gameState.cps = 0;
            gameState.conquered = false;
            
            buildings.forEach(b => {
                b.count = 0;
                b.cooldown = 0;
            });
            
            efficiencyUpgrades.forEach(u => {
                u.count = 0;
                u.cooldown = 0;
            });
            
            closeModal();
            renderBuildings();
            renderEfficiencyUpgrades();
            renderBuildingsDisplay();
            updateDisplay();
            showNotification(`Renacimiento #${gameState.rebirths}! +${gameState.rebirths * 15}% producci√≥n`);
        }

        init();
    </script>
</body>
</html>
